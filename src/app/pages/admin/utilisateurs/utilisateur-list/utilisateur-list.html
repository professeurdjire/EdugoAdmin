<div class="users-page-container">
  <h1 class="page-title">Utilisateurs</h1>
  
  <!-- Loading indicator -->
  <div *ngIf="loading" class="loading-indicator">
    <p>Chargement des utilisateurs...</p>
  </div>
  
  <!-- Error message -->
  <div *ngIf="error" class="error-message">
    <p>{{ error }}</p>
    <button class="retry-btn" (click)="loadUsers()">Réessayer</button>
  </div>
  
  <!-- Filtres -->
  <div class="filter" *ngIf="!loading && !error">
    <section class="filters-container">
      <div class="filter-group">
        <label>Recherche</label>
        <input type="text" [(ngModel)]="searchTerm" placeholder="Nom, email..." />
      </div>

      <div class="filter-group">
        <label>Niveau scolaire</label>
        <select [(ngModel)]="selectedNiveau">
          <option>Tous les niveaux</option>
          <option>2ème</option>
          <option>3ème</option>
          <option>4ème</option>
        </select>
      </div>

      <div class="filter-group">
        <label>Statut</label>
        <select [(ngModel)]="selectedStatus">
          <option>Tous les statuts</option>
          <option>Actif</option>
          <option>Inactif</option>
        </select>
      </div>

      <div class="action-buttons">
        <button class="filter-btn" (click)="applyFilters()">
          <fa-icon [icon]="faFilter"></fa-icon>
          Filtrer
        </button>
        <button class="reset-btn" (click)="resetFilters()">
          <fa-icon [icon]="faRedoAlt"></fa-icon>
          Réinitialiser
        </button>
      </div>
    </section>
  </div>
  
  <div class="table-header-info" *ngIf="!loading && !error">
    <h2>Liste des utilisateurs ({{ filteredUsers.length }})</h2>
  </div>

  <!-- Tableau sans pagination -->
  <section class="users-table-section no-scroll" *ngIf="!loading && !error">
    <div class="table-wrapper">
      <table>
        <thead>
        <tr>
          <th>Utilisateur</th>
          <th>Niveau</th>
          <th>Téléphone</th>
          <th>Points</th>
          <th>Statut</th>
          <th>Actions</th>
        </tr>
        </thead>
        <tbody>
        <tr *ngFor="let user of pagedUsers">
          <td class="user-details-cell">
            <div class="user-initials" [ngClass]="user.color">{{ user.initials }}</div>
            <div class="user-info-text">
              <p class="name">{{ user.firstName }} {{ user.lastName }}</p>
              <small class="email">{{ user.email }}</small>
            </div>
          </td>
          <td><span class="level-badge">{{ user.niveau }}</span></td>
          <td>{{ user.telephone }}</td>
          <td>{{ user.points }}</td>
          <td>
              <span class="status-badge" [class.active-status]="user.status === 'Actif'">
                {{ user.status }}
              </span>
          </td>
          <td class="actions-cell">
            <span class="action-btn view-btn" (click)="viewUser(user)">
              <fa-icon [icon]="faEye"></fa-icon>
            </span>
            <span class="action-btn edit-btn" (click)="editUser(user)">
              <fa-icon [icon]="faPen"></fa-icon>
            </span>
          </td>
        </tr>
        </tbody>
      </table>
      
      <!-- Pagination -->
      <div class="book-list__footer" *ngIf="totalPages > 1">
        <p>Affichage de {{ displayedFrom }} à {{ displayedTo }} sur {{ totalFiltered }} utilisateurs</p>
        <nav class="pagination">
          <button class="pagination__arrow" (click)="changePage(currentPage - 1)" [disabled]="currentPage === 1">
            <img src="/images/430_2316.svg" alt="Previous">
          </button>
          
          <ng-container *ngFor="let page of pageNumbers">
            <button 
              class="pagination__number" 
              [class.active]="page === currentPage"
              (click)="changePage(page)">
              {{ page }}
            </button>
          </ng-container>
          
          <button class="pagination__arrow" (click)="changePage(currentPage + 1)" [disabled]="currentPage === totalPages">
            <img src="/images/430_2314.svg" alt="Next">
          </button>
        </nav>
      </div>
      
      <!-- No data message -->
      <div class="no-data-message" *ngIf="filteredUsers.length === 0">
        <p>Aucun utilisateur trouvé.</p>
      </div>
    </div>
  </section>
</div>