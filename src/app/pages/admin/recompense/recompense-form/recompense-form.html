<div class="form-main-container">
  <!-- Votre formulaire ici -->
  <div class="ajout-challenge-container">

    <div class="form-header">
      <h1 class="main-title">Ajouter un badge</h1>
      <a routerLink="/admin/recompenselist" class="back-btn">
        <span class="icon">⮜</span> Retour
      </a>
    </div>

    <p class="tagline">Définissez les informations de ce badge de récompense.</p>

    <form class="challenge-form" [formGroup]="form" (ngSubmit)="onSubmit()">

      <div class="section-block">
        <div class="section-header">
          <span class="header-icon material-symbols-info">ⓘ</span>
          <h2 class="section-title">Informations de base</h2>
        </div>
        <hr class="section-divider">

        <div class="form-grid grid-2-cols">
          <div class="form-group">
            <label for="nom">Nom du badge *</label>
            <input type="text" id="nom" class="form-control" placeholder="Ex: Champion des Quiz" formControlName="nom">
          </div>
          <div class="form-group">
            <label for="type">Type de badge *</label>
            <select id="type" class="form-control" formControlName="type">
              <option value="">Sélectionner un type</option>
              <option value="OR">Or</option>
              <option value="ARGENT">Argent</option>
              <option value="BRONZE">Bronze</option>
              <option value="SPECIAL">Spécial</option>
              <option value="PROGRESSION">Progression</option>
            </select>
            <small class="form-hint" *ngIf="form.get('type')?.value === 'PROGRESSION'">
              ℹ️ Les badges de progression sont attribués automatiquement aux élèves lorsqu'ils atteignent certains seuils de points. 
              Définissez le seuil de points requis pour ce badge ci-dessous.
            </small>
          </div>

          <div class="form-group full-width">
            <label for="description">Description</label>
            <textarea id="description" rows="3" class="form-control" placeholder="Description du badge (conditions, contexte...)" formControlName="description"></textarea>
          </div>

          <div class="form-group">
            <label for="icone">Icône du badge</label>
            <div class="icon-picker">
              <div class="icon-picker-list">
                <button type="button"
                        class="icon-option"
                        *ngFor="let icon of availableIcons"
                        (click)="selectIcon(icon)"
                        [class.selected]="form.get('icone')?.value === icon">
                  {{ icon }}
                </button>
              </div>
              <div class="icon-picker-input">
                <input type="text" id="icone" class="form-control"
                       placeholder="Ou saisissez un emoji personnalisé"
                       formControlName="icone">
              </div>
            </div>
          </div>

          <!-- Champs spécifiques pour les badges de progression -->
          <div class="form-group" *ngIf="form.get('type')?.value === 'PROGRESSION'">
            <label for="seuil">Seuil de points *</label>
            <input type="number" id="seuil" class="form-control" 
                   placeholder="Ex: 100, 500, 1000..." 
                   formControlName="seuil"
                   min="1"
                   [class.error]="form.get('seuil')?.invalid && form.get('seuil')?.touched">
            <small class="form-hint">
              Nombre de points que l'élève doit accumuler pour obtenir automatiquement ce badge de progression.
            </small>
            <div class="error-message" *ngIf="form.get('seuil')?.invalid && form.get('seuil')?.touched">
              <span *ngIf="form.get('seuil')?.errors?.['required']">Le seuil de points est requis pour les badges de progression.</span>
              <span *ngIf="form.get('seuil')?.errors?.['min']">Le seuil doit être supérieur à 0.</span>
            </div>
          </div>
        </div>
      </div>

      <div class="form-actions-footer">
        <button type="button" class="btn-action btn-cancel-large" (click)="onAnnuler()" [disabled]="isLoading">
          <span class="icon">✕</span> Annuler
        </button>
        <button type="submit" class="btn-action btn-submit-large" [disabled]="form.invalid || isLoading">
          <span class="icon">+</span> {{ isEditMode ? 'Mettre à jour le badge' : 'Créer le badge' }}
        </button>
      </div>

    </form>
  </div>
</div>

