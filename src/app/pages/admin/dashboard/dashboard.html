<div class="dashboard-container">
  <main class="main-content">
    <section class="stats-cards-container">
      <div class="stat-cards-deco">
        <div class="stat-card ">
          <div class="icon-containerA">
            <fa-icon [icon]="faUsers"></fa-icon>
          </div>
          <div class="alignementTexte">
            <div class="value">{{ (statistiques?.totalEleves ?? 0) | number }}</div>
            <div class="label">Nombre d'utilisateurs</div>
          </div>
        </div>
      </div>

      <div class="stat-cards-deco">
        <div class="stat-card">
          <div class="icon-containerB">
            <fa-icon [icon]="faBook"></fa-icon>
          </div>
          <div class="alignementTexte">
            <div class="value">{{ (statistiques?.totalLivres ?? 0) | number }}</div>
            <div class="label">Nombre de livres</div>
          </div>
        </div>
      </div>

      <div class="stat-cards-deco">
        <div class="stat-card ">
          <div class="icon-containerC">
            <fa-icon [icon]="faSquarePollHorizontal"></fa-icon>
          </div>
          <div class="alignementTexte">
            <div class="value">{{ (statistiques?.totalQuiz ?? 0) | number }}</div>
            <div class="label">Nombre de quiz</div>
          </div>
        </div>
      </div>

      <div class="stat-cards-deco">
        <div class="stat-card ">
          <div class="icon-containerD">
            <fa-icon [icon]="faFlagCheckered"></fa-icon>
          </div>
          <div class="alignementTexte">
            <div class="value">{{ (statistiques?.totalDefis ?? 0) | number }}</div>
            <div class="label">Total défis</div>
          </div>
        </div>
      </div>
    </section>

    <section class="dashboard-grid">
      <!-- Graphique des activités avec ApexCharts -->
      <div class="grid-item activity-chart">
        <div class="item-header">
          <h2>Activités des utilisateurs</h2>
          <select class="chart-options">
            <option>7 derniers jours</option>
          </select>
        </div>
        <div class="chart-placeholder">
          
          <div class="graph-area">
            <apx-chart
              [series]="chartOptions.series"
              [chart]="chartOptions.chart"
              [xaxis]="chartOptions.xaxis"
              [plotOptions]="chartOptions.plotOptions"
              [dataLabels]="chartOptions.dataLabels"
              [stroke]="chartOptions.stroke"
              [fill]="chartOptions.fill"
              [colors]="chartOptions.colors"
              [legend]="chartOptions.legend">
            </apx-chart>
          </div>
        </div>
      </div>

      <!-- Actions rapides -->
      <div class="grid-item quick-actions">
        <h2>Actions Rapides</h2>
        <div class="traitA"> </div>
        <div class="actions-container">
          <a class="action-btn" routerLink="/admin/ajouterlivre">
            <fa-icon [icon]="faBookMedical" class="btn-icon"></fa-icon>
            <span>Ajouter un livre</span>
          </a>

          <a class="action-btn" routerLink="/admin/ajouterQuiz">
            <fa-icon [icon]="faPlusCircle" class="btn-icon"></fa-icon>
            <span>Ajouter un quiz</span>
          </a>

          <a class="action-btn" routerLink="/admin/ajouterdefi">
            <fa-icon [icon]="faFlagCheckered" class="btn-icon"></fa-icon>
            <span>Ajouter un défi</span>
          </a>

          <a class="action-btn" routerLink="/admin/ajouterchallenge">
            <fa-icon [icon]="faMedal" class="btn-icon"></fa-icon>
            <span>Ajouter un challenge</span>
          </a>
        </div>
      </div>

      <!-- Répartition de lecture -->
<div class="grid-item reading-distribution">
  <h2>Répartition de lecture par matière</h2>
  <div class="trait"></div>
  <div class="distribution-content">
    <!-- Graphique à GAUCHE -->
    <div class="pie-chart-placeholder">
      <apx-chart
        [series]="readingDonutOptions.series"
        [chart]="readingDonutOptions.chart"
        [labels]="readingDonutOptions.labels"
        [colors]="readingDonutOptions.colors"
        [plotOptions]="readingDonutOptions.plotOptions"
        [dataLabels]="readingDonutOptions.dataLabels"
        [responsive]="readingDonutOptions.responsive">
      </apx-chart>
    </div>
    
    <!-- Légende à DROITE -->
    <ul class="legend">
      <li class="maths">Mathématiques</li>
      <li class="francais">Français</li>
      <li class="histoires">Histoires</li>
      <li class="geographie">Géographie</li>
      <li class="anglais">Anglais</li>
      <li class="ecm">ECM</li>
      <li class="physique">Physique</li>
      <li class="chimie">Chimie</li>
    </ul>
  </div>
</div>

      <!-- Top utilisateurs -->
      <div class="grid-item top-users">
        <div class="item-header">
          <h2>Top Utilisateurs</h2>
          <a routerLink="/admin/utilisateurs" class="view-all">Voir tout</a>
        </div>
        <ul class="user-list" *ngIf="topUsers.length > 0; else noTopUsers">
          <li class="user-item" *ngFor="let u of topUsers">
            <div class="user-initials-small">{{ u.initials }}</div>
            <div class="user-details-small">
              <p>{{ u.fullName }}</p>
              <small>{{ u.level || 'Niveau à venir' }}</small>
            </div>
            <span class="points">
              {{ u.points > 0 ? (u.points + ' pts') : '—' }}
            </span>
          </li>
        </ul>
        <ng-template #noTopUsers>
          <p class="no-data-message">Aucun utilisateur à afficher pour l'instant.</p>
        </ng-template>
      </div>
    </section>
  </main>
</div>
